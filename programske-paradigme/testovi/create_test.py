"""
Креирање теста из лекција Програмских парадигми (лекције 1-4)
"""

from docx import Document
from docx.shared import Pt, Inches
from docx.enum.text import WD_ALIGN_PARAGRAPH

# Креирамо документ
doc = Document()

# Наслов
title = doc.add_heading('Тест из Програмских парадигми', 0)
title.alignment = WD_ALIGN_PARAGRAPH.CENTER

subtitle = doc.add_paragraph('Лекције 1-4: О програмским парадигмама, Императивна, Објектно-оријентисана и Скрипт парадигма')
subtitle.alignment = WD_ALIGN_PARAGRAPH.CENTER

doc.add_paragraph('Име и презиме: _________________________________')
doc.add_paragraph('Датум: _________________________________')
doc.add_paragraph()

# Упутство
doc.add_heading('Упутство:', 2)
doc.add_paragraph('Тест садржи питања вишеструког избора, питања са допуњавањем и питања повезивања. Пажљиво прочитајте свако питање пре одговора.')
doc.add_paragraph()

# ===== ДЕО 1: ПИТАЊА ВИШЕСТРУКОГ ИЗБОРА =====
doc.add_heading('Део I: Питања вишеструког избора (заокружите тачан одговор)', 1)

questions_mc = [
    {
        'q': 'Која парадигма се заснива на организацији кода око објеката који садрже податке и методе?',
        'options': [
            'a) Императивна парадигма',
            'b) Објектно-оријентисана парадигма',
            'c) Функционална парадигма',
            'd) Логичка парадигма'
        ],
        'correct': 'b'
    },
    {
        'q': 'Шта је основна техника изражавања алгоритама у императивној парадигми?',
        'options': [
            'a) Рекурзија',
            'b) Декларација',
            'c) Итерација',
            'd) Композиција функција'
        ],
        'correct': 'c'
    },
    {
        'q': 'Који концепт ООП омогућава да се подаци и методе пакују унутар објекта и сакрију детаљи имплементације?',
        'options': [
            'a) Наслеђивање',
            'b) Полиморфизам',
            'c) Енкапсулација',
            'd) Апстракција'
        ],
        'correct': 'c'
    },
    {
        'q': 'Која наредба је карактеристична за композитну парадигму и раније програмске језике?',
        'options': [
            'a) IF-THEN-ELSE',
            'b) WHILE',
            'c) FOR',
            'd) GOTO'
        ],
        'correct': 'd'
    },
    {
        'q': 'Који језик се користи за скриптове на страни клијента у веб-прегледачима?',
        'options': [
            'a) PHP',
            'b) JavaScript',
            'c) Python',
            'd) C#'
        ],
        'correct': 'b'
    },
    {
        'q': 'Шта је карактеристика скрипт језика?',
        'options': [
            'a) Компилирају се у машински код',
            'b) Интерпретирају се током извршавања',
            'c) Користе се искључиво за системско програмирање',
            'd) Не подржавају објектно-оријентисано програмирање'
        ],
        'correct': 'b'
    },
    {
        'q': 'Која парадигма описује ШТА програм треба да постигне, а не КАКО да то уради?',
        'options': [
            'a) Императивна парадигма',
            'b) Декларативна парадигма',
            'c) Процедурална парадигма',
            'd) Структурирана парадигма'
        ],
        'correct': 'b'
    },
    {
        'q': 'Који механизам ООП омогућава да изведена класа преузме својства и методе базне класе?',
        'options': [
            'a) Енкапсулација',
            'b) Полиморфизам',
            'c) Наслеђивање',
            'd) Апстракција'
        ],
        'correct': 'c'
    },
]

for i, item in enumerate(questions_mc, 1):
    p = doc.add_paragraph()
    p.add_run(f'{i}. {item["q"]}').bold = True
    for opt in item['options']:
        doc.add_paragraph(opt, style='List Bullet')
    doc.add_paragraph()

# ===== ДЕО 2: ДОПУНИ РЕЧЕНИЦЕ =====
doc.add_page_break()
doc.add_heading('Део II: Допуните реченице', 1)

fill_blanks = [
    'Основна наредба којом се мења стање програма у императивној парадигми је наредба _______________.',
    'У објектно-оријентисаном програмирању, конкретна инстанца класе назива се _______________.',
    'Концепт који омогућава да метода има различито понашање у зависности од класе којој припада назива се _______________.',
    '_______________ је специјализован језик који се често користи за скриптовање у играма попут World of Warcraft.',
    'У систему Windows, скриптове за командну линију чувамо у датотекама са екстензијом _______________.',
    'Када функција приликом позива мења вредности глобалних променљивих, кажемо да има _______________ ефекте.',
]

for i, question in enumerate(fill_blanks, 1):
    doc.add_paragraph(f'{i}. {question}')
doc.add_paragraph()

# ===== ДЕО 3: ПОВЕЖИ ПОЈМОВЕ =====
doc.add_page_break()
doc.add_heading('Део III: Повежите појмове са описима', 1)

doc.add_paragraph('Повежите термине из леве колоне са одговарајућим описима из десне колоне (напишите слово испред броја).')
doc.add_paragraph()

matching = [
    ('1. Структурирано програмирање', 'A. Шаблон који дефинише структуру и понашање објеката'),
    ('2. Класа', 'B. Скриптови који се извршавају на веб-серверу'),
    ('3. Мутабилно стање', 'C. Парадигма која користи петље уместо GOTO наредби'),
    ('4. Беч датотеке', 'D. Стање које се може мењати током извршавања програма'),
    ('5. Серверски скриптови', 'E. Датотеке са командама које се извршавају једна за другом'),
]

# Лева колона
doc.add_heading('Термини:', 3)
for term, _ in matching:
    doc.add_paragraph(f'{term}  _____', style='List Bullet')

doc.add_paragraph()

# Десна колона  
doc.add_heading('Описи:', 3)
for _, desc in matching:
    doc.add_paragraph(desc, style='List Bullet')

doc.add_paragraph()

# ===== ДЕО 4: КРАТКИ ОДГОВОРИ =====
doc.add_page_break()
doc.add_heading('Део IV: Кратки одговори', 1)

short_answer = [
    'Наведите три кључна концепта објектно-оријентисаног програмирања.',
    'Објасните разлику између императивне и декларативне парадигме.',
    'Зашто је наредба GOTO замењена структурираним конструкцијама попут петљи?',
]

for i, question in enumerate(short_answer, 1):
    doc.add_paragraph(f'{i}. {question}')
    doc.add_paragraph('_' * 80)
    doc.add_paragraph('_' * 80)
    doc.add_paragraph()

# ===== ДЕО 5: АНАЛИЗА КОДА =====
doc.add_page_break()
doc.add_heading('Део V: Анализа кода', 1)

doc.add_paragraph('Погледајте следећи императивни код и одговорите на питања:')
doc.add_paragraph()

code = '''int x = 5;
int n = 3;
int i = 0;
int rezultat = 1;
while (i < n) {
    rezultat *= x;
    i++;
}'''

code_p = doc.add_paragraph(code)
code_p.style = 'No Spacing'
for run in code_p.runs:
    run.font.name = 'Courier New'
    run.font.size = Pt(10)

doc.add_paragraph()
doc.add_paragraph('1. Шта ће бити вредност променљиве rezultat након извршавања овог кода?')
doc.add_paragraph('_' * 80)
doc.add_paragraph()
doc.add_paragraph('2. Који математички израчунавање овај код имплементира?')
doc.add_paragraph('_' * 80)
doc.add_paragraph()
doc.add_paragraph('3. Која основна техника императивног програмирања је примењена у овом коду?')
doc.add_paragraph('_' * 80)

# ===== ОДГОВОРИ (на крају) =====
doc.add_page_break()
heading = doc.add_heading('ОДГОВОРИ - САМО ЗА НАСТАВНИКА', 0)
heading.alignment = WD_ALIGN_PARAGRAPH.CENTER

# Одговори на питања вишеструког избора
doc.add_heading('Део I: Питања вишеструког избора', 1)
for i, item in enumerate(questions_mc, 1):
    correct_answer = item['correct']
    correct_option = [opt for opt in item['options'] if opt.startswith(correct_answer)][0]
    p = doc.add_paragraph()
    run = p.add_run(f'{i}. {correct_option}')
    run.bold = True
    run.font.color.rgb = None  # Црна боја

# Одговори на допуњавање
doc.add_heading('Део II: Допуните реченице', 1)
fill_answers = [
    '1. доделе (или assignment)',
    '2. објекат (или инстанца)',
    '3. полиморфизам',
    '4. Lua',
    '5. .bat (или bat)',
    '6. бочне (или споредне, пропратне, side)',
]
for answer in fill_answers:
    p = doc.add_paragraph(answer)
    p.runs[0].bold = True

# Одговори на повезивање
doc.add_heading('Део III: Повежите појмове', 1)
matching_answers = [
    '1. C (Структурирано програмирање - Парадигма која користи петље уместо GOTO наредби)',
    '2. A (Класа - Шаблон који дефинише структуру и понашање објеката)',
    '3. D (Мутабилно стање - Стање које се може мењати током извршавања програма)',
    '4. E (Беч датотеке - Датотеке са командама које се извршавају једна за другом)',
    '5. B (Серверски скриптови - Скриптови који се извршавају на веб-серверу)',
]
for answer in matching_answers:
    p = doc.add_paragraph(answer)
    p.runs[0].bold = True

# Одговори на кратке одговоре
doc.add_heading('Део IV: Кратки одговори', 1)
short_answers = [
    '1. Три кључна концепта ООП: Енкапсулација, Наслеђивање, Полиморфизам',
    '2. Императивна парадигма описује КАКО програм треба да ради (наредбе, стање, итерација), док декларативна парадигма описује ШТА програм треба да постигне (без наређивања како).',
    '3. GOTO је замењен јер је стварао тешко читљив код са компликованим током извршавања ("шпагети код"). Структуриране конструкције (петље, гранања) стварају јаснију и лакшу за одржавање структуру кода.',
]
for answer in short_answers:
    p = doc.add_paragraph(answer)
    p.runs[0].bold = True

# Одговори на анализу кода
doc.add_heading('Део V: Анализа кода', 1)
code_answers = [
    '1. Вредност променљиве rezultat ће бити 125 (5³ = 5 × 5 × 5)',
    '2. Код имплементира степеновање (x^n, односно x на степен n)',
    '3. Итерација (помоћу while петље)',
]
for answer in code_answers:
    p = doc.add_paragraph(answer)
    p.runs[0].bold = True

# Сачувај документ
output_path = 'test-01-programske-paradigme-sa-odgovorima.docx'
doc.save(output_path)

print(f"Тест је успешно креиран: {output_path}")
print(f"\nСтруктура теста:")
print(f"  - Део I: 8 питања вишеструког избора")
print(f"  - Део II: 6 питања допуњавања")
print(f"  - Део III: 5 питања повезивања")
print(f"  - Део IV: 3 кратка одговора")
print(f"  - Део V: 3 питања анализе кода")
print(f"\nУкупно: 25 питања")
